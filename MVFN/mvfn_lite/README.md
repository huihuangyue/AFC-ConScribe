# MVFNâ€‘lite ä»£ç ç»“æ„è¯´æ˜

æœ¬æ–‡ä»¶æè¿° mvfn_lite ç›®å½•ä¸‹â€œæ‹Ÿå®šçš„æ–‡ä»¶ç»“æ„â€ï¼Œé€ä¸€ç»™å‡ºï¼šä½œç”¨ã€è¾“å…¥ã€è¾“å‡ºã€ä¸»è¦ä¾èµ–ä¸è¢«è°è°ƒç”¨ã€‚é™¤è®¾è®¡æ–‡æ¡£å¤–ï¼Œæä¾›äº†ä¸€ä¸ªå®ç”¨çš„ç¦»çº¿åˆ†æè„šæœ¬ï¼Œä¾¿äºç›´æ¥åœ¨é‡‡é›†äº§ç‰©ä¸Šåšå…ƒç´ é™æ€/åŠ¨æ€çš„å¯è§†åŒ–æ ‡æ³¨ã€‚æœ¬æ–‡åŒæ—¶è§„åˆ’äº†â€œç½‘ç»œè¯·æ±‚ä¸ DOM å˜æ›´è®°å½• + API/æ•°æ®åº“é©±åŠ¨å…³è”â€çš„æ‰©å±•æ¥å£ï¼ˆä»…æ–‡æ¡£ï¼Œæš‚ä¸ç¼–å†™ä»£ç ï¼‰ã€‚

## å®ç”¨è„šæœ¬ï¼ˆç¦»çº¿å…ƒç´ åˆ†ç±»ï¼‰

- element_classify_offline.py
  - ä½œç”¨ï¼šè¾“å…¥ `workspace/data/<domain>/<ts>/` ç›®å½•ï¼ŒåŸºäº `dom_summary*.json` ä¸ `controls_tree.json` å°†é¡µé¢å…ƒç´ ï¼ˆæ§ä»¶æ ‘èŠ‚ç‚¹ï¼‰ç¦»çº¿åˆ†ç±»ä¸ºï¼š
    - `static`ï¼šåˆå§‹å³å­˜åœ¨ä¸”æœªæ˜æ˜¾å˜åŒ–ï¼›
    - `dynamic`ï¼šæ»šåŠ¨åæ–°å¢æˆ–æ˜¾è‘—å˜åŒ–ï¼›
    - `db_likely`ï¼šå¯å‘å¼æç¤ºï¼ˆä¿¡æ¯æµ/å¡ç‰‡/å¹¿å‘Šç­‰ï¼‰ï¼Œå¹¶éä¸¥æ ¼çš„â€œæ¥å…¥æ•°æ®åº“â€è¯æ˜ã€‚
  - è¾“å‡ºï¼š
    - `<dir>/element_classification.json`ï¼ˆæ¯èŠ‚ç‚¹æ ‡ç­¾ä¸æ±‡æ€»ï¼‰ï¼Œ
    - `<dir>/element_classified_overlay.png`ï¼ˆåœ¨ `screenshot_loaded.png` ä¸Šå½©è‰²å åŠ ï¼‰ã€‚
  - ç”¨æ³•ï¼š
    ```bash
    python MVFN/mvfn_lite/element_classify_offline.py \
      --dir workspace/data/bing_com/20251108202329 \
      --image screenshot_loaded.png \
      --alpha 40 --thickness 3
    ```
    - è¯´æ˜ï¼šè‹¥è¦æ›´å¯é åœ°åˆ¤æ–­â€œAPI/æ•°æ®åº“é©±åŠ¨â€ï¼Œåº”åœ¨é‡‡é›†é˜¶æ®µè®°å½•ç½‘ç»œè¯·æ±‚ä¸ DOM å˜æ›´æ—¶åºå¹¶åœ¨æœ¬è„šæœ¬ä¸­åšå…³è”ï¼ˆåç»­å¯æ‰©å±•ï¼‰ã€‚

## å·¥å…·ä¸è„šæœ¬æ€»è§ˆï¼ˆä½œç”¨ä¸ç”¨æ³•ï¼‰

- `run_text_pipeline.py`
  - ä½œç”¨ï¼šä¸€é”®è¿è¡Œâ€œå€™é€‰ç”Ÿæˆ + æ–‡æœ¬è¯æ®æå–â€ã€‚è‹¥ `AFC/` å·²å­˜åœ¨ï¼Œå°†æ¸…ç©ºåé‡å»ºï¼Œç¡®ä¿äº§ç‰©æ–°é²œã€‚
  - ç”¨æ³•ï¼š
    ```bash
    python -m MVFN.mvfn_lite.run_text_pipeline --dir workspace/data/<domain>/<ts>
    ```
  - è¾“å‡ºï¼š
    - `AFC/candidates.json`ï¼ˆå« stats/ratesï¼šå„æ­¥æ•°é‡ä¸ç­›é€‰ç‡ï¼‰
    - `AFC/evidence_text.json`

- `candidate_generation.py`
  - ä½œç”¨ï¼šä¼˜å…ˆåŸºäº `controls_tree.json` ç”Ÿæˆå€™é€‰ï¼›å¤±è´¥æ—¶å›é€€ `dom_summary*.json`ã€‚æä¾›æ§ä»¶å¯å‘å¼è¯„åˆ†ä¸å»é‡ã€‚
  - è°ƒç”¨ï¼ˆæ¨¡å—ï¼‰ï¼š
    ```python
    from MVFN.mvfn_lite.candidate_generation import generate_candidates
    generate_candidates('<data_dir>')
    ```

- `evidence_text.py`
  - ä½œç”¨ï¼šåŸºäº DOM ä¸ºå€™é€‰æå–ä¸»æ–‡æœ¬ä¸è¯æ®ç‰‡æ®µï¼›è¾“å‡º `text_quality` æŒ‡æ ‡ã€‚
  - è°ƒç”¨ï¼ˆæ¨¡å—ï¼‰ï¼š
    ```python
    from MVFN.mvfn_lite.evidence_text import build_text_evidence
    build_text_evidence('<data_dir>')
    ```

- `metrics_scoring.py`
  - ä½œç”¨ï¼šç»Ÿè®¡æŒ‡æ ‡å¹¶ç”Ÿæˆç»¼åˆç½®ä¿¡åº¦ï¼ˆfinal_confidenceï¼‰ã€‚
  - ç”¨æ³•ï¼š
    ```bash
    python -m MVFN.mvfn_lite.metrics_scoring --dir workspace/data/<domain>/<ts>
    ```
  - è¾“å‡ºï¼š
    - `AFC/metrics.json`ï¼ˆå«ç­›é€‰æ­¥éª¤ç»Ÿè®¡ä¸ç›´æ–¹ï¼‰
    - `AFC/candidates_scored.json`ï¼ˆä¸ºæ¯ä¸ªå€™é€‰é™„åŠ  final_confidenceï¼‰

- `overlay_candidates.py`
  - ä½œç”¨ï¼šæŠŠ topâ€‘Nï¼ˆfinal_confidence â‰¥ é˜ˆå€¼ï¼‰çš„å€™é€‰å åŠ ç”»åœ¨æˆªå›¾ä¸Šï¼Œç»“æœé»˜è®¤å†™å…¥ `AFC/` ç›®å½•ã€‚
  - ç”¨æ³•ï¼š
    ```bash
    python -m MVFN.mvfn_lite.overlay_candidates \
      --dir workspace/data/<domain>/<ts> \
      --topn 50 --min-conf --thickness 3 --alpha 0
    ```
  - è¾“å‡ºï¼š
    - `AFC/afc_top_candidates_overlay.png`

- `element_classify_offline.py`
  - ä½œç”¨ï¼šé™æ€/åŠ¨æ€/db_likely ç¦»çº¿æ ‡æ³¨ï¼ˆä½¿ç”¨ dom æ‘˜è¦ä¸æ§ä»¶æ ‘ï¼‰ã€‚
  - ç”¨æ³•è§ä¸Šï¼›è¾“å‡º `element_classification.json` ä¸ `element_classified_overlay.png`ã€‚


## é‡‡é›†æ‰©å±•è®¾è®¡ï¼šç½‘ç»œè¯·æ±‚ä¸ DOM å˜æ›´æ—¥å¿—ï¼ˆä»…æ–‡æ¡£ï¼‰

ç›®æ ‡ï¼šåœ¨ä¸ä¾èµ–åœ¨çº¿æ¥å£è°ƒç”¨ä¸ Cookie æ³¨å…¥çš„å‰æä¸‹ï¼Œé€šè¿‡é‡‡é›†é˜¶æ®µçš„â€œç½‘ç»œè¯·æ±‚æ—¥å¿— + DOM å˜æ›´æ—¶åºâ€æ¥æ¨æ–­å“ªäº›é¡µé¢å…ƒç´ ç”± API/åç«¯æ•°æ®é©±åŠ¨ï¼Œä»è€Œåœ¨ç¦»çº¿è„šæœ¬ä¸­è¿›è¡Œæ›´å¯é çš„ `api_likely` æ ‡æ³¨ï¼ˆç›¸è¾ƒäºå¯å‘å¼ `db_likely`ï¼‰ã€‚

ä¸€ï¼‰é‡‡é›†å™¨è¾“å‡ºæ–°å¢æ–‡ä»¶ï¼ˆdetect å±‚å»ºè®®å®ç°ï¼Œæ–‡ä»¶å‘½åä¸ç»“æ„çº¦å®šï¼‰
- `network.json`
  - äº‹ä»¶æµï¼š`events: [{id, t_start, t_end?, url, method, status, mime, transfer_size, initiator}]`
  - å–èˆï¼šä»…æŒä¹…åŒ– XHR/fetch/JSON/HTML æ–‡æ¡£ä¸å›¾ç‰‡ç­‰å…³é”®èµ„æºï¼›å¿½ç•¥é™æ€å°èµ„æºï¼ˆé˜ˆå€¼ 1â€“2KB å¯é…ç½®ï¼‰ã€‚
  - æ—¶é—´ï¼šä½¿ç”¨ `performance.now()` æˆ–â€œé‡‡é›†å™¨å•è°ƒæ—¶é—´â€ï¼›ä¸ `mutations.json` å…±æ—¶åŸºã€‚
- `mutations.json`
  - äº‹ä»¶æµï¼š`mutations: [{t, type: 'added|text|attributes', index, bbox, page_bbox, selector, container?, text?}]`
  - é‡‡é›†æ–¹å¼ï¼šé¡µé¢æ³¨å…¥ `MutationObserver`ï¼›è½ç›˜å‰åšé™æµä¸é‡‡æ ·ï¼ˆé˜²çˆ†å†…å­˜ï¼‰ã€‚
- å…¼å®¹ï¼šè‹¥æµè§ˆå™¨æˆ– CSP ç¦æ­¢æ³¨å…¥/ç›‘å¬ï¼Œåˆ™å†™å‡ºç©ºæ•°ç»„å¹¶åœ¨ `meta.warnings` æ ‡è®° `NETWORK_CAPTURE_UNAVAILABLE`/`MUTATION_CAPTURE_UNAVAILABLE`ã€‚

äºŒï¼‰ç¦»çº¿å…³è”ç®—æ³•ï¼ˆmvfn_lite å±‚å»ºè®®å®ç°ï¼‰
- è¾“å…¥ï¼š`network.json`ã€`mutations.json`ã€`controls_tree.json`ã€`dom_summary*.json`ã€æˆªå›¾ã€‚
- å…³è”æ­¥éª¤ï¼š
  1. è¿‡æ»¤å“åº”ï¼š`mime in {application/json, text/json}` æˆ– `url` å‘½ä¸­ `/api|/ajax|/feed|/graph|/search`ï¼›è®°ä¸ºå€™é€‰ API å“åº”ã€‚
  2. æ—¶é—´çª—åŒ¹é…ï¼šå¯¹æ¯æ¡ API å“åº”ï¼Œåœ¨ `t_end ~ t_end+Î”t` çª—ï¼ˆå¦‚ 0.1â€“2.0sï¼‰å†…æ”¶é›†æ¶‰åŠå†…å®¹å—ï¼ˆcontent å‹ï¼‰çš„å˜æ›´äº‹ä»¶ï¼ˆadded/text/attributesï¼‰ã€‚
  3. ç©ºé—´çº¦æŸï¼šå°†å˜æ›´èŠ‚ç‚¹æ˜ å°„åˆ° `controls_tree.nodes`ï¼Œé™å®šåœ¨æ»šåŠ¨å®¹å™¨æˆ–è§†å£é™„è¿‘ï¼Œæ’é™¤æ‚¬æµ®/é®ç½©å±‚ã€‚
  4. æ‰“åˆ†ï¼šæ—¶é—´æ¥è¿‘åº¦ + å˜æ›´è§„æ¨¡ï¼ˆèŠ‚ç‚¹æ•°/é¢ç§¯ï¼‰+ æ–‡æœ¬å˜åŒ–å¼ºåº¦ + èµ„æºä½“ç§¯/çŠ¶æ€ç ï¼›è¶…è¿‡é˜ˆå€¼åˆ™å°†ç›¸å…³èŠ‚ç‚¹æ ‡æ³¨ä¸º `api_likely` å¹¶é™„ä¸Šè¯æ® `{api: {url, t_end, score, nodes:[idâ€¦]}}`ã€‚
- è¾“å‡ºï¼šåœ¨ `element_classification.json` çš„èŠ‚ç‚¹æ¡ç›®ä¸­è¿½åŠ  `source: static|dynamic|db_likely|api_likely`ï¼›ä¼˜å…ˆçº§ `api_likely > db_likely > dynamic > static`ã€‚

ä¸‰ï¼‰æ–°å¢/è°ƒæ•´çš„ CLIï¼ˆdetect ä¸è„šæœ¬ï¼Œå»ºè®®ï¼‰
- detectï¼ˆé‡‡é›†é˜¶æ®µï¼Œå»ºè®®æ–°å¢å¼€å…³ï¼‰ï¼š
  - `--capture-network`ï¼ˆé»˜è®¤å¼€ï¼‰å†™å‡º `network.json`ï¼›
  - `--capture-mutations`ï¼ˆé»˜è®¤å¼€ï¼‰å†™å‡º `mutations.json`ï¼›
  - `--capture-budget events=5000, window_ms=2000, min_kb=1` æ§åˆ¶é‡‡æ ·ä¸é˜ˆå€¼ã€‚
- mvfn_liteï¼ˆç¦»çº¿è„šæœ¬ï¼Œå»ºè®®æ–°å¢å‚æ•°ï¼‰ï¼š
  - `--link-api` å¯ç”¨å…³è”è®¡ç®—ï¼ˆé»˜è®¤å¼€ï¼Œè‹¥æ—  `network.json/mutations.json` åˆ™è·³è¿‡ï¼‰ã€‚

å››ï¼‰JSON è‰æ¡ˆï¼ˆä¾¿äºå®ç°æ—¶ç›´æ¥è½åœ°ï¼‰
- network.json
```json
{
  "version": "v0.1",
  "events": [
    {"id": 1, "t_start": 123.4, "t_end": 456.7, "url": "https://â€¦/api/feed", "method": "GET", "status": 200, "mime": "application/json", "transfer_size": 84231, "initiator": "script"}
  ]
}
```
- mutations.json
```json
{
  "version": "v0.1",
  "mutations": [
    {"t": 458.0, "type": "added", "index": 123, "bbox": [x,y,w,h], "page_bbox": [X,Y,W,H], "selector": "div.card", "text": "â€¦"}
  ]
}
```

> æ³¨ï¼šä¸Šè¿°ä¸ºçº¦å®šä¸æ¥å£è®¾è®¡ï¼Œå½“å‰é˜¶æ®µä¸æäº¤å®ç°ä»£ç ï¼›detect ä¸è„šæœ¬æŒ‰è¯¥çº¦å®šå¯¹é½åå³å¯æ— ç¼è”åŠ¨ã€‚

## æ€»å…¥å£ä¸ç±»å‹

- pipeline.py
  - ä½œç”¨ï¼šä¸»æµæ°´çº¿ç¼–æ’ï¼Œå°†å„é˜¶æ®µæŒ‰é¡ºåº/æ¡ä»¶è¿æ¥ï¼Œå½¢æˆ `run(inputs) -> afc_nodes` ä¸»æµç¨‹ã€‚
  - è¾“å…¥ï¼šScreenshotã€DOM ç®€è¡¨ã€AX æ ‘ã€ï¼ˆå¯é€‰ï¼‰OCR ç»“æœä¸é…ç½®ï¼›ç»Ÿä¸€å°è£…ä¸º `PipelineInputs`ã€‚
  - è¾“å‡ºï¼šAFC èŠ‚ç‚¹åˆ—è¡¨ï¼ˆå«æ ‡ç­¾/åŠ¨ä½œ/bbox/æ–‡æœ¬/è¯æ®/ç½®ä¿¡åº¦/å‘é‡/å…³ç³»ï¼‰ã€‚
  - ä¾èµ–ï¼šcandidate_generationã€evidence/*ã€rules/classifierã€scoring/fusionã€refine/llm_refiner?ã€embedding/encoderã€relations/graph_builderã€export/dedup+sinkã€configã€‚

- types.py
  - ä½œç”¨ï¼šé›†ä¸­å®šä¹‰ `Candidate`ã€`Evidence`ã€`AFCNode`ã€`PipelineInputs/Outputs` ç­‰æ•°æ®ç»“æ„ä¸åè®®ã€‚
  - è¾“å…¥ï¼šæ— ï¼ˆç±»å‹å®šä¹‰è¢«åŠ¨è¢«å¼•ç”¨ï¼‰ã€‚
  - è¾“å‡ºï¼šç±»å‹ä¸åè®®ï¼Œä¾›æ‰€æœ‰æ¨¡å— import ä½¿ç”¨ã€‚
  - ä¾èµ–ï¼šæ— ï¼›è¢«å…¨å±€å„æ¨¡å—å¼•ç”¨ã€‚

- config.pyï¼ˆå¯é€‰å®ç°ï¼‰
  - ä½œç”¨ï¼šè¯»å–ä¸æ ¡éªŒé…ç½®é¡¹/ç‰¹æ€§å¼€å…³ï¼ˆOCR/LLM/Embedding/æƒé‡/å¯¼å‡ºç­‰ï¼‰ã€‚
  - è¾“å…¥ï¼šç¯å¢ƒå˜é‡ã€é…ç½®æ–‡ä»¶ï¼ˆYAML/JSONï¼‰ã€‚
  - è¾“å‡ºï¼š`Config` å¯¹è±¡ï¼ˆå«é˜ˆå€¼ã€æƒé‡ã€æœåŠ¡ç«¯ç‚¹ç­‰ï¼‰ã€‚
  - ä¾èµ–ï¼šæ— ï¼›è¢« pipeline ä¸å„å­æ¨¡å—è¯»å–ã€‚

- logging.pyï¼ˆå¯é€‰å®ç°ï¼‰
  - ä½œç”¨ï¼šç»Ÿä¸€æ—¥å¿—/äº‹ä»¶ä¸é˜¶æ®µäº§ç‰©å¿«ç…§ï¼ˆä¾¿äºå¤ç°ä¸è°ƒå‚ï¼‰ã€‚
  - è¾“å…¥ï¼šé˜¶æ®µè¾“å‡º/æŒ‡æ ‡ã€‚
  - è¾“å‡ºï¼šç»“æ„åŒ–æ—¥å¿—ä¸å¯è§†åŒ–æ‰€éœ€çš„å…ƒæ•°æ®ã€‚
  - ä¾èµ–ï¼šæ— ï¼›è¢«å„æ¨¡å—è°ƒç”¨ã€‚

## å€™é€‰ç”Ÿæˆ

- candidate_generation.py
  - ä½œç”¨ï¼šä» DOM/AX ç”Ÿæˆå¯æ“ä½œæ§ä»¶å€™é€‰ï¼Œå®Œæˆå¯è§æ€§/é®æŒ¡/é‡å è¿‡æ»¤ä¸å»å™ªã€‚
  - è¾“å…¥ï¼šDOM ç®€è¡¨ã€AX æ ‘ã€ï¼ˆå¯é€‰ï¼‰å¯è§æ€§å¿«ç…§ã€‚
  - è¾“å‡ºï¼š`Candidate[]`ï¼ˆå« id/role/bbox/visible/raw_texts/dom_ref/ax_refï¼‰ã€‚
  - ä¾èµ–ï¼štypesã€configï¼›è¢« pipeline é¦–å…ˆè°ƒç”¨ã€‚

## è¯æ®æå–ï¼ˆevidence/ï¼‰

- evidence/text_extractor.py
  - ä½œç”¨ï¼šä¼˜å…ˆä» AX/aria/innerText/placeholder/label-for ç­‰æŠ½å–æ–‡æœ¬å¹¶æ¸…æ´—ï¼Œå½¢æˆä¸»è¦æ–‡æœ¬ä¸æ–‡æœ¬è¯æ®ã€‚
  - è¾“å…¥ï¼š`Candidate[]` + AX/DOM å¼•ç”¨ã€‚
  - è¾“å‡ºï¼šä¸ºå€™é€‰é™„åŠ  `main_text` ä¸ `evidence(type=text, source=AX/DOM, score=â€¦)`ã€‚
  - ä¾èµ–ï¼štypesã€configï¼›è¢« pipeline åœ¨å€™é€‰ç”Ÿæˆä¹‹åè°ƒç”¨ã€‚

- evidence/ocr_adapter.pyï¼ˆå¯é€‰ï¼‰
  - ä½œç”¨ï¼šåœ¨æ–‡æœ¬ä¸è¶³æ—¶å¯¹æˆªå›¾æŒ‰å€™é€‰ bbox è¿›è¡Œ OCRï¼Œè¡¥å……æ–‡æœ¬è¯æ®å¹¶ç¼“å­˜ã€‚
  - è¾“å…¥ï¼šScreenshotï¼Œå€™é€‰ bbox åŒºåŸŸï¼ŒOCR é…ç½®ã€‚
  - è¾“å‡ºï¼šæ–‡æœ¬æ¡†ä¸ç½®ä¿¡åˆ†ï¼Œé™„åŠ åˆ°å€™é€‰ `evidence(type=text, source=OCR)`ã€‚
  - ä¾èµ–ï¼šå¤–éƒ¨ OCRï¼ˆæœ¬åœ°æˆ–æœåŠ¡åŒ–ï¼‰ã€typesã€configï¼›è¢« pipeline æ¡ä»¶è°ƒç”¨ã€‚

- evidence/icon_semantics.py
  - ä½œç”¨ï¼šè¯†åˆ«å›¾æ ‡ç±»çº¿ç´¢ï¼ˆclass/SVG/ariaï¼‰å¹¶æ˜ å°„è¯­ä¹‰å…³é”®è¯ï¼ˆå¦‚ search/closeï¼‰ã€‚
  - è¾“å…¥ï¼šå€™é€‰çš„å›¾æ ‡ç›¸å…³å±æ€§æˆ–é‚»è¿‘å°å›¾å…ƒã€‚
  - è¾“å‡ºï¼š`evidence(type=icon, value=semantic_keyword, score=â€¦)`ã€‚
  - ä¾èµ–ï¼šå†…ç½®å°è¯è¡¨ï¼ˆJSONï¼‰ï¼Œtypesï¼›è¢« pipeline è°ƒç”¨ã€‚

## è§„åˆ™åˆ†ç±»ï¼ˆrules/ï¼‰

- rules/classifier.py
  - ä½œç”¨ï¼šåŸºäºåˆ«åè¯å…¸ä¸æ­£åˆ™ï¼Œå°†å€™é€‰å½’ä¸€åˆ°æ ‡å‡† `label` ä¸ `action`ã€‚
  - è¾“å…¥ï¼šæºå¸¦æ–‡æœ¬/å›¾æ ‡/è§’è‰²/ä¸Šä¸‹æ–‡ç­‰è¯æ®çš„å€™é€‰ã€‚
  - è¾“å‡ºï¼šåŠ å…¥ `label`ã€`action` å­—æ®µå’Œåˆ†ç±»å‘½ä¸­æ˜ç»†ã€‚
  - ä¾èµ–ï¼š`rules/alias_lexicon.json`ã€`rules/regex_rules.yaml`ã€typesã€configï¼›è¢« pipeline è°ƒç”¨ã€‚

- rules/alias_lexicon.jsonï¼ˆæ•°æ®æ–‡ä»¶ï¼‰
  - ä½œç”¨ï¼šåŒä¹‰è¯/åˆ«åæ˜ å°„ï¼ˆæäº¤/å‘é€/ç¡®è®¤ â†’ Submitï¼›æœç´¢/æŸ¥æ‰¾/ğŸ” â†’ Searchï¼‰ã€‚
  - è¾“å…¥ï¼šæ— ï¼ˆé™æ€è¯è¡¨ï¼‰ã€‚
  - è¾“å‡ºï¼šè¢« classifier æŸ¥è¯¢ä½¿ç”¨ã€‚
  - ä¾èµ–ï¼šæ— ï¼›è¢« classifier è¯»å–ã€‚

- rules/regex_rules.yamlï¼ˆæ•°æ®æ–‡ä»¶ï¼‰
  - ä½œç”¨ï¼šå¤šè¯­è¨€/å˜ä½“æ­£åˆ™ï¼ˆå«ä¼˜å…ˆçº§ä¸æ ‡ç­¾/åŠ¨ä½œæ˜ å°„ï¼‰ã€‚
  - è¾“å…¥ï¼šæ— ï¼ˆé™æ€è§„åˆ™ï¼‰ã€‚
  - è¾“å‡ºï¼šè¢« classifier æŸ¥è¯¢ä¸åŒ¹é…ä½¿ç”¨ã€‚
  - ä¾èµ–ï¼šæ— ï¼›è¢« classifier è¯»å–ã€‚

## æ‰“åˆ†èåˆï¼ˆscoring/ï¼‰

- scoring/fusion.py
  - ä½œç”¨ï¼šå°†æ–‡æœ¬/è§’è‰²/ä¸Šä¸‹æ–‡/å›¾æ ‡ç­‰å±€éƒ¨åˆ†å€¼èåˆä¸ºæ•´ä½“ç½®ä¿¡åº¦ï¼Œè¾“å‡ºå¯è§£é‡Šæ˜ç»†ã€‚
  - è¾“å…¥ï¼šå·²åˆ†ç±»çš„å€™é€‰åŠå…¶è¯æ®åˆ†å€¼ã€èåˆæƒé‡ã€‚
  - è¾“å‡ºï¼šæ›´æ–°åçš„ `confidence` ä¸è´¡çŒ®åº¦æ˜ç»†ã€‚
  - ä¾èµ–ï¼štypesã€configï¼›è¢« pipeline è°ƒç”¨ã€‚

## å¯é€‰å¾®è°ƒï¼ˆrefine/ï¼‰

- refine/llm_refiner.pyï¼ˆå¯é€‰ï¼‰
  - ä½œç”¨ï¼šå¯¹ä½ç½®ä¿¡åº¦æ ·æœ¬è°ƒç”¨å¤–éƒ¨ LLM æ ¹æ®è¯æ®æ‘˜è¦å¾®è°ƒæ ‡ç­¾/åŠ¨ä½œã€‚
  - è¾“å…¥ï¼šè¯æ®æ‘˜è¦ã€ä¸Šä¸‹æ–‡ç‰‡æ®µä¸é…ç½®ï¼ˆé˜ˆå€¼/ç«¯ç‚¹/å¯†é’¥ï¼‰ã€‚
  - è¾“å‡ºï¼šè°ƒæ•´åçš„æ ‡ç­¾/åŠ¨ä½œ/ç½®ä¿¡åº¦æˆ–è§£é‡Šç†ç”±ã€‚
  - ä¾èµ–ï¼šå¤–éƒ¨ LLM æœåŠ¡ã€typesã€configï¼›è¢« pipeline æ¡ä»¶è°ƒç”¨ã€‚

## å‘é‡ä¸å…³ç³»ï¼ˆembedding/ï¼Œrelations/ï¼‰

- embedding/encoder.py
  - ä½œç”¨ï¼šå°†æ§ä»¶è¯­ä¹‰ç¼–ç ä¸ºå‘é‡ï¼Œç”¨äºæ£€ç´¢ä¸åŒ¹é…ã€‚
  - è¾“å…¥ï¼šæ§ä»¶ `label`ã€`main_text`ã€ä¸Šä¸‹æ–‡æ‘˜è¦åŠæ¨¡å‹é…ç½®ã€‚
  - è¾“å‡ºï¼š`embedding: float[]`ã€‚
  - ä¾èµ–ï¼šæœ¬åœ°æˆ–æœåŠ¡åŒ–å‘é‡æ¨¡å‹ã€typesã€configï¼›è¢« pipeline è°ƒç”¨ã€‚

- relations/graph_builder.py
  - ä½œç”¨ï¼šæ„å»ºæ§ä»¶é—´çš„è¡¨å•/åŒè¡Œ/é‚»æ¥ç­‰å…³ç³»ã€‚
  - è¾“å…¥ï¼šæ§ä»¶é›†åˆä¸å…¶å¸ƒå±€/åˆ†ç»„ä¿¡æ¯ã€‚
  - è¾“å‡ºï¼šä¸ºæ§ä»¶é™„åŠ  `relations[]`ã€‚
  - ä¾èµ–ï¼štypesï¼›è¢« pipeline è°ƒç”¨ã€‚

## å¯¼å‡ºä¸å»é‡ï¼ˆexport/ï¼‰

- export/dedup.py
  - ä½œç”¨ï¼šåŸºäºæ–‡æœ¬ç›¸ä¼¼/ç©ºé—´ IOU/åŠ¨ä½œç±»å‹è¿›è¡Œå»é‡åˆå¹¶ï¼Œä¿ç•™è¯æ®æ¥æºã€‚
  - è¾“å…¥ï¼šæ§ä»¶é›†åˆã€‚
  - è¾“å‡ºï¼šå»é‡åçš„æ§ä»¶é›†åˆã€‚
  - ä¾èµ–ï¼štypesï¼›è¢« pipeline è°ƒç”¨å¹¶åœ¨ sink å‰æ‰§è¡Œã€‚

- export/sink.py
  - ä½œç”¨ï¼šå°†æœ€ç»ˆ AFC èŠ‚ç‚¹å¯¼å‡ºè‡³ä¸‹æ¸¸ï¼ˆæ–‡ä»¶/DB/ç´¢å¼•ï¼‰ã€‚
  - è¾“å…¥ï¼šæœ€ç»ˆæ§ä»¶é›†åˆä¸å¯¼å‡ºé…ç½®ã€‚
  - è¾“å‡ºï¼šæŒä¹…åŒ–è½åœ°æˆ–ç´¢å¼•å†™å…¥ç»“æœã€‚
  - ä¾èµ–ï¼štypesã€configï¼›è¢« pipeline æœ€åè°ƒç”¨ã€‚

## é˜¶æ®µ I/O æ€»è§ˆï¼ˆç®€è¡¨ï¼‰
- è¾“å…¥ï¼ˆæ•´ä½“ï¼‰ï¼šScreenshotã€DOM ç®€è¡¨ã€AX æ ‘ã€ï¼ˆå¯é€‰ï¼‰OCRï¼›è§„åˆ™ä¸é…ç½®ã€‚
- è¾“å‡ºï¼ˆæ•´ä½“ï¼‰ï¼šAFC èŠ‚ç‚¹åˆ—è¡¨ï¼ˆæ ‡ç­¾/åŠ¨ä½œ/bbox/æ–‡æœ¬/è¯æ®/åˆ†å€¼/å‘é‡/å…³ç³»ã€å¯è§£é‡Šæ˜ç»†ï¼‰ã€‚

> è¯´æ˜ï¼šä¸Šè¿°æ–‡ä»¶ä¸ºâ€œæ‹Ÿå®šç»“æ„â€ï¼Œä¸ºåç»­å®ç°æä¾›æ˜ç¡®è¾¹ç•Œã€‚å½“å‰é˜¶æ®µä¸åˆ›å»ºä»»ä½• `.py` æˆ–æ•°æ®æ–‡ä»¶ï¼Œé¿å…è¶Šç•Œå®ç°ã€‚
