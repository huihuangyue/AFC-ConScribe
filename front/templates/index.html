<!DOCTYPE html>
<html lang="zh">

  <head>
  <meta charset="UTF-8">
  <title>Browser Agent Control Panel</title>
  <link rel="stylesheet" href="/static/style.css">
  <script>
    // 由后端注入的当前 run_dir 与执行模式，前端可用于调用后端 API
    window.CURRENT_RUN_DIR = "{{ run_dir|default('') }}";
    window.EXEC_MODE = "{{ exec_mode|default('planner') }}";  // planner | browser_use
  </script>
  </head>

<body>
  <!-- 左侧悬浮日志抽屉（仅空架子，后续再接入真实日志数据） -->
  <div class="log-drawer" id="logDrawer">
    <div class="log-handle">LOG</div>
    <div class="log-content">
      <div class="log-header">📜 日志面板（预留）</div>
      <div class="log-body">
        <p>这里将来用于展示与切换日志文件，目前仅为占位 UI，不参与任何逻辑。</p>
      </div>
    </div>
  </div>

  <div class="main-container">
    <div class="browser-pane">
      <div class="pane-header">🌐 实时浏览器视图 (VNC)</div>
      <!-- 左侧是通过 noVNC 暴露的远程浏览器画面，起始 URL 由 run_dir 推导后编码进查询参数 -->
      <iframe src="{{ vnc_url }}" class="browser-frame" id="browserFrame"></iframe>
    </div>

    <div class="chat-pane">
      <div class="pane-header">🤖 Agent 对话记录</div>

      <div class="chat-history" id="chatHistory">
        <div class="message agent-msg">
          <div class="avatar">A</div>
          <div class="bubble">你好！我是浏览器智能体。请输入任务，例如：“打开百度并搜索 Playwright”。</div>
        </div>
      </div>

      <div class="input-area">
        <textarea id="userInput" placeholder="在此输入自然语言任务..."></textarea>
        <button onclick="submitUnified()">提交任务</button>
      </div>
    </div>
  </div>
  <script src="/static/script.js"></script>
</body>

</html>
